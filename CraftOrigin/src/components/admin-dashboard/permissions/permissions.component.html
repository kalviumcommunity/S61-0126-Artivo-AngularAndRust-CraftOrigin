<div class="permissions-page">
  <h2 class="page-title">User Management</h2>
  <p class="page-desc">Manage platform users and their account status.</p>
  
  <div *ngIf="loading" class="loading">Loading users...</div>
  
  <div *ngIf="errorMsg" class="error-msg">
    {{ errorMsg }}
    <button (click)="loadUsers()" class="btn-retry">Retry</button>
  </div>

  <div *ngIf="!loading && !errorMsg && users.length === 0" class="empty">No users found.</div>
  
  <div *ngIf="!loading && !errorMsg && users.length > 0" class="table-wrap">
    <table class="data-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Status</th>
          <th>Joined</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td><span class="role-badge">{{ user.role }}</span></td>
          <td>
            <span class="status-badge" [class.active]="user.active" [class.inactive]="!user.active">
              {{ user.active ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td>{{ user.created_at | date:'mediumDate' }}</td>
          <td>
            <button 
              *ngIf="user.role !== 'ADMIN'"
              class="btn-toggle"
              [class.btn-activate]="!user.active"
              [class.btn-deactivate]="user.active"
              [disabled]="processingId === user.id"
              (click)="toggleStatus(user)"
            >
              {{ user.active ? 'Deactivate' : 'Activate' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<style>
  .table-wrap { overflow-x: auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
  .data-table { width: 100%; border-collapse: collapse; }
  .data-table th, .data-table td { padding: 1rem; text-align: left; border-bottom: 1px solid #eee; }
  .data-table th { background: #f9f9f9; font-weight: 600; }
  
  .role-badge { background: #e0e7ff; color: #3730a3; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
  .status-badge { padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; font-weight: 500; }
  .status-badge.active { background: #dcfce7; color: #166534; }
  .status-badge.inactive { background: #fee2e2; color: #991b1b; }
  
  .btn-toggle { padding: 0.4rem 0.8rem; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; }
  .btn-activate { background: #22c55e; color: white; }
  .btn-deactivate { background: #ef4444; color: white; }
  .btn-toggle:disabled { opacity: 0.7; cursor: not-allowed; }

  .error-msg { color: #dc2626; padding: 1rem; background: #fee2e2; border-radius: 8px; margin-bottom: 1rem; display: flex; align-items: center; gap: 1rem; }
  .btn-retry { padding: 0.4rem 0.8rem; background: #fff; border: 1px solid #dc2626; color: #dc2626; border-radius: 4px; cursor: pointer; }
  .btn-retry:hover { background: #fee2e2; }
</style>
